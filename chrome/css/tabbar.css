/*@name         RunningCheese Firefox
  @author       RunningCheese
  @homepage     https://www.runningcheese.com
  @version      2022-05-04 for ff100+
  @version      2021-07-22 for ff90+
  @version      2021-01-27 for ff85+
  @version      2020-09-24 for ff82+
  @version      2020-07-04 for ff78+
  @version      2020-02-11 for ff73+
  @version      2019-12-22 for ff71+
  @version      2019-09-22 for ff70+
  @version      2019-05-23 
  @version      2018-12-25 
  @version      2018-11-12 
  @version      2018-06-17 for ff60+
  @version      2018-04-08       
*/


/* ===================================== 标签栏调整 ===================================== */


/*标签最大宽度调整*/
.tabbrowser-tab[fadein]:not([pinned]) {
    max-width: 240px !important;
    overflow: hidden;
}


/*!*标签上方距离*!*/
/*:root[sizemode="normal"] #toolbar-menubar + toolbar {*/
/*    margin-top: 6px !important;*/
/*}*/

/*:root[sizemode="maximized"] #toolbar-menubar + toolbar {*/
/*    margin-top: 6px !important;*/
/*}*/

/*:root[sizemode="fullscreen"] #toolbar-menubar + toolbar {*/
/*    margin-top: -2px !important;*/
/*}*/


/*!*标签高度*!*/
/*#titlebar, #tabbrowser-tabs {*/
/*    --tab-min-height: 34px !important;*/
/*}*/

.tab-background {
    margin-block: 1px !important;
}


/*标签栏默认主题颜色*/
@media (prefers-color-scheme: light) {
    :root:not(:-moz-lwtheme) #navigator-toolbox {
        --lwt-accent-color: #DEE1E5 !important;
        --toolbar-bgcolor: #ffffff !important;
        background-color: #DEE1E5 !important;
    }
}

@media (prefers-color-scheme: dark) {
    :root:not(:-moz-lwtheme) #navigator-toolbox {
        --lwt-accent-color: #353d49 !important;
        --toolbar-bgcolor: #465467 !important;
        background-color: #353d49 !important;
    }
}


/*标签栏明亮主题颜色*/
:root[style*="--lwt-accent-color: rgb(240, 240, 244); --lwt-text-color: rgba(21, 20, 26);"] #navigator-toolbox {
    --lwt-accent-color: #eeeeee !important;
    --toolbar-bgcolor: #ffffff !important;
    background-color: #eeeeee !important;
}


/*标签栏深色主题颜色*/
:root[style*="--lwt-accent-color: rgb(28, 27, 34); --lwt-text-color: rgba(251, 251, 254);"] #navigator-toolbox {
    --lwt-accent-color: #353d49 !important;
    --toolbar-bgcolor: #465467 !important;
    background-color: #353d49 !important;
}

:root[style*="--lwt-accent-color: rgb(28, 27, 34); --lwt-text-color: rgba(251, 251, 254);"] #urlbar-background {
    background-color: #353d49 !important;
}

:root[style*="--lwt-accent-color: rgb(28, 27, 34); --lwt-text-color: rgba(251, 251, 254);"] .toolbarbutton-1 {
    --toolbarbutton-hover-background: #353d49 !important;
    --toolbarbutton-active-background: #353d49 !important;
}

:root[style*="--lwt-accent-color: rgb(28, 27, 34); --lwt-text-color: rgba(251, 251, 254);"] #PlacesToolbarItems .bookmark-item:not([_moz-menuactive="true"]):hover {
    background-color: #353d49 !important;
}

:root[style*="--lwt-accent-color: rgb(28, 27, 34); --lwt-text-color: rgba(251, 251, 254);"] #OtherBookmarks:hover {
    background-color: #353d49 !important;
}


/* -------------------------- 彩虹标签页--------------------------- */

/* 去除标签页阴影*/
#tabbrowser-tabs:not([noshadowfortests]) .tab-background:is([selected], [multiselected]),
#TabsToolbar:not([brighttext]) #tabbrowser-tabs:not([noshadowfortests]) .tabbrowser-tab:is([visuallyselected=true], [multiselected]) > .tab-stack > .tab-background[selected],
#TabsToolbar:not([brighttext]) #tabbrowser-tabs:not([noshadowfortests]) .tabbrowser-tab:is([visuallyselected=true], [multiselected]) > .tab-stack > .tab-background[multiselected],
:root[lwthemetextcolor="dark"] #TabsToolbar:not([brighttext]) #tabbrowser-tabs:not([noshadowfortests]) .tabbrowser-tab:is([visuallyselected=true], [multiselected]) > .tab-stack > .tab-background[selected],
:root[lwthemetextcolor="dark"] #TabsToolbar:not([brighttext]) #tabbrowser-tabs:not([noshadowfortests]) .tabbrowser-tab:is([visuallyselected=true], [multiselected]) > .tab-stack > .tab-background[multiselected] {
    box-shadow: none !important;
}

/* 选中标签颜色 */
:root[style*="--lwt-accent-color: rgb(240, 240, 244); --lwt-text-color: rgba(21, 20, 26);"] .tabbrowser-tab:is([selected]):-moz-lwtheme {
    color: #ffffff !important;
}


/* 选中标签边框 */
.tab-background:is([selected], [multiselected]):-moz-lwtheme {
    outline: 0px solid var(--lwt-tab-line-color, var(--lwt-tabs-border-color, currentColor)) !important;
    border: 1px solid var(--lwt-tab-line-color, var(--lwt-tabs-border-color, currentColor)) !important;
    border-bottom: 0px !important;
}

:root[style*="--lwt-accent-color: rgb(240, 240, 244); --lwt-text-color: rgba(21, 20, 26);"] .tab-background:is([selected], 
:root[style*="--lwt-accent-color: rgb(240, 240, 244); --lwt-text-color: rgba(21, 20, 26);"] [multiselected]):-moz-lwtheme {
    border: 0px !important;
}


/* 魅力蓝 Blue */
:root[style*="--lwt-accent-color: rgb(240, 240, 244); --lwt-text-color: rgba(21, 20, 26);"] #TabsToolbar:not([brighttext]) #tabbrowser-tabs:not([noshadowfortests]) .tab-background:is([selected], [multiselected]) {
    -moz-border-image: none !important;
    background: -moz-linear-gradient(left, #00c0f1, #0080e2) !important;
    /*background: -moz-linear-gradient(left, #4BB3F9, #3071F7) !important;*/
    --lwt-header-image: none !important;
}


/*森林绿 Green*/
:root[style*="--lwt-accent-color: rgb(240, 240, 244); --lwt-text-color: rgba(21, 20, 26);"] #TabsToolbar:not([brighttext]) #tabbrowser-tabs:not([noshadowfortests]) .tabbrowser-tab[visuallyselected]:-moz-any(
[image*="siv/TLIr/0yyK/9Msiv/TLIr/0yyK/9Msiv/TLIr/0yyK/9Msiv/T"],/*feedly*/
[image*="GgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAABtlBMVEUAAAAMxWQIwmIJw2MHwWEHwmEIw"],/*weixin*/
[image*="YAG4EEAAAAAAAAAAAAAAEEAAHKZgAmC2pAP8tqAD/LagA/y2oAP8t"],/*evernote*/
[image*="iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAAC91BMVEUAAAAFvQAFvQAFvQAH3QA"],/*iqiyi*/
[image*="xcARqEAL0ahAJRGoQDWRqEA9kahAPlGoQDYRqEAlkahADFOixcATosXAE6LFwBOix"],/*360*/
[image*="EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8"],/*douban*/
[image*="IMbOsWQxWikcvPRVFqKaKyQhejKcipfRUPPQUiAcpHrx5kSL1IK0HXQ2SKqXUSo/VHkREZFNjM7O"]/*weichat*/)
.tab-background:is([selected], [multiselected]) {
    background: -moz-linear-gradient(left, #68d045, #22ae02) !important;
}

/*活力橙 Orange*/
:root[style*="--lwt-accent-color: rgb(240, 240, 244); --lwt-text-color: rgba(21, 20, 26);"] #TabsToolbar:not([brighttext]) #tabbrowser-tabs:not([noshadowfortests]) .tabbrowser-tab[visuallyselected]:-moz-any(
[image*="AODAAADwwAAA/8EAAP/DAAD//wAA"],/*weibo*/
[image*="//wPgf/4H8B/4D/gH4B/8AAA//wAA///AA/8="],/*sogou*/
[image*="EHEAAAABAAAADwAAgH8AAA=="],/*hunantv*/
[image*="HwAAAABgB///AAAAAEAP/8MAAH//wA//AAAAf/+AH/8AgA"]/*taobao*/)
.tab-background:is([selected], [multiselected]) {
    background: -moz-linear-gradient(left, #ffc43d, #ff5a15) !important;
}


/*热情红 Red*/
:root[style*="--lwt-accent-color: rgb(240, 240, 244); --lwt-text-color: rgba(21, 20, 26);"] #TabsToolbar:not([brighttext]) #tabbrowser-tabs:not([noshadowfortests]) .tabbrowser-tab[visuallyselected]:-moz-any(
[image*="iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQ"],/*youtube*/
[image*="AADiRw8P8Y8PAPgfDw///wAA"],/*163*/
[image*="AD/gAAB/8AAA//wAA///AA/8="],/*163music*/
[image*="AAABAAkAMDAQAAEABABoBgAAlgAAACAg"],/*jd*/
[image*="QLIAEMAAOjFAc5l/ExwAAAAAElFTkSuQmCC"],/*tmall*/
[image*="BpcAvNM8U1IpUANcAAAAASUVORK5CYII="],/*quora*/
[image*="AAABAAEAICAAAAEAIACoEAAAFgAAACgAAAAgAAAAQAAAAAEAIAAAAAAAABAAAAAAAAAAA"],/*hupu*/
[image*="z9f8FV5lSOT6VjY8AAAAASUVORK5CYII="]/*pintereste*/)
.tab-background:is([selected], [multiselected]) {
    background: -moz-linear-gradient(left, #fb7e62, #dc1500) !important;
}

/*可爱粉 Pink*/

:root[style*="--lwt-accent-color: rgb(240, 240, 244); --lwt-text-color: rgba(21, 20, 26);"] #TabsToolbar:not([brighttext]) #tabbrowser-tabs:not([noshadowfortests]) .tabbrowser-tab[visuallyselected]:-moz-any(
[image*="fgH/gP8B/4H/gf+D/8H/////8="],/*bilibili*/
[image*="AAABAAQAQEAAAAEAIAAoQAAARgAA"],/*dribbble*/
[image*="D6AS9PFwSRG3qkAAAAAElFTkSuQmCC"]/*meilishuo*/)
.tab-background:is([selected], [multiselected]) {
    background: -moz-linear-gradient(left, #e842c5, #e951b6) !important;
}


/*热情红 Red*/
:root[style*="--lwt-accent-color: rgb(240, 240, 244); --lwt-text-color: rgba(21, 20, 26);"] #TabsToolbar:not([brighttext]) #tabbrowser-tabs:not([noshadowfortests]) .tabbrowser-tab[visuallyselected]:-moz-any(
[image*="iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQ"],/*youtube*/
[image*="AADiRw8P8Y8PAPgfDw///wAA"],/*163*/
[image*="AD/gAAB/8AAA//wAA///AA/8="],/*163music*/
[image*="AAABAAkAMDAQAAEABABoBgAAlgAAACAg"],/*jd*/
[image*="QLIAEMAAOjFAc5l/ExwAAAAAElFTkSuQmCC"],/*tmall*/
[image*="BpcAvNM8U1IpUANcAAAAASUVORK5CYII="],/*quora*/
[image*="AAABAAEAICAAAAEAIACoEAAAFgAAACgAAAAgAAAAQAAAAAEAIAAAAAAAABAAAAAAAAAAA"],/*hupu*/
[image*="z9f8FV5lSOT6VjY8AAAAASUVORK5CYII="]/*pintereste*/)
.tab-background:is([selected], [multiselected]) {
    background: -moz-linear-gradient(left, #fb7e62, #dc1500) !important;
}


/*高端黑 Black*/
:root[style*="--lwt-accent-color: rgb(240, 240, 244); --lwt-text-color: rgba(21, 20, 26);"] #TabsToolbar:not([brighttext]) #tabbrowser-tabs:not([noshadowfortests]) .tabbrowser-tab[visuallyselected]:-moz-any(
[image*="ZNXA473oCuKP75pWY/KosW8v+Z26TLCDkxCwAAAABJRU5ErkJggg=="],/*steampowered*/
[image*="MTEuOTggNy40OCAxMC44NkM3LjMyIDEwLjQ2IDYuNzYgOC44MiA3LjY0IDYuNjJDNy42NCA2LjYyIDguOTg"]/*github*/)
.tab-background:is([selected], [multiselected]) {
    background: -moz-linear-gradient(left, #777777, #333333) !important;
}


/*商务蓝 Facebook Blue*/
:root[style*="--lwt-accent-color: rgb(240, 240, 244); --lwt-text-color: rgba(21, 20, 26);"] #TabsToolbar:not([brighttext]) #tabbrowser-tabs:not([noshadowfortests]) .tabbrowser-tab[visuallyselected]:-moz-any(
[image*="AAAAA6nULGOZwBuPlbwT/5W8E/+VvBP/lbwT/5W8E/+VvBP/lbwT/5W8E"]/*facebook*/)
.tab-background:is([selected], [multiselected]) {
    background: -moz-linear-gradient(left, #4761A2, #465F9F) !important;
}

/*基佬紫 pruple*/
/* background: -moz-linear-gradient(left, #b55ef1, #7b40e3) !important;}*/


/*香槟金 Champagne*/
:root[style*="--lwt-accent-color: rgb(240, 240, 244); --lwt-text-color: rgba(21, 20, 26);"] #TabsToolbar:not([brighttext]) #tabbrowser-tabs:not([noshadowfortests]) .tabbrowser-tab[visuallyselected]:-moz-any(
[image*="BoBAAANgAAACAgAAABACAAqBAAAJ4EAABAQAAAAQAgAChCAABGFQAAKAAAABAAAAAgAAAAAQAgAAAAAAAABAAAAAAAAAA/"],/*apple*/
/*[image*="0RjkzMTFFOTgxNDg5QzQzMzc2NDQxQTAiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUFDRkFCMDI0RjkzMTFFOTgxND"]*/ /*huawei*/)
.tab-background:is([selected], [multiselected]) {
    background: -moz-linear-gradient(left, #e8d7a2, #ceaa4e) !important;
}


/*宝石蓝 Jewel Blue*/
:root[style*="--lwt-accent-color: rgb(240, 240, 244); --lwt-text-color: rgba(21, 20, 26);"] #TabsToolbar:not([brighttext]) #tabbrowser-tabs:not([noshadowfortests]) .tabbrowser-tab[visuallyselected]:-moz-any(
[image*="qFkYOqNQC0WlVROP3Lug6Pr18vLOoHrfr2cqe6tfHzcAAAAAAAAAAKFMB"],/*runningcheese*/
[image*="AIAAAAAAAAABgAAAAAAAAAHAAAAAAAAAA+AAAAAAAAAH+AAAAAAAAB8="]/*baidu*/)
.tab-background:is([selected], [multiselected]) {
    background: -moz-linear-gradient(left, #398fed, #2256e2) !important;
}

/*深邃模式*/
:root[style*="--lwt-accent-color: rgb(28, 27, 34); --lwt-text-color: rgba(251, 251, 254);"] #TabsToolbar #tabbrowser-tabs:not([noshadowfortests]) .tabbrowser-tab .tab-background:is([selected], [multiselected]) {
    background: #465467 !important;
}


/*为空白标签加上图标 Add icon for blank tabs */
#TabsToolbar .tabbrowser-tab .tab-icon-image:not([src]):not([busy]):not([pending]),
#TabsToolbar .tabbrowser-tab .tab-icon-image:not([src]):not([busy]):not([pending]):not([selected]) {
    display: inline !important;
    list-style-image: url("chrome://global/skin/icons/defaultFavicon.svg") !important;
}


/*隐藏 Firefox View 右侧分割线 */
#tabbrowser-tabs {
    border-inline-start: none !important;
}


/*= 标签页调整 Root - Reduce Padding ================================================== */

/* 参考代码 source form:  https://github.com/black7375/Firefox-UI-Fix*/

/*:root {*/
/*    !* Tab Bar *!*/
/*    --proton-tab-block-margin: 2px !important;*/
/*    !* Original: 4px *!*/
/*    --tab-block-margin: 2px !important;*/
/*    !* New version of --proton-tab-block-margin *!*/
/*    --inline-tab-padding: 6px !important;*/
/*    !* Original: 8px *!*/
/*    !* Panel *!*/
/*    --arrowpanel-menuicon-padding: 8px;*/
/*    --arrowpanel-menuitem-margin: 0 var(--arrowpanel-menuicon-padding) !important;*/
/*    !* Original: 0 8px *!*/
/*    --arrowpanel-menuitem-padding: 5px !important;*/
/*    !* Original: 8px *!*/
/*    --arrowpanel-padding: 0.8em !important;*/
/*    !* Original: 16px or .cui-widget-panel, .cui-widget-panel::part(arrowcontent) => 4px 0 *!*/
/*}*/

/*:root[uidensity=compact] {*/
/*    !* Tool Bar *!*/
/*    --toolbarbutton-outer-padding: 2px !important;*/
/*    !* Original: 3px, General is 2px *!*/
/*    !* Panel *!*/
/*    --arrowpanel-menuitem-padding: 3px !important;*/
/*    !* Original: 8px *!*/
/*}*/

/*:root[uidensity=touch] {*/
/*    !* Tab Bar - Like Original *!*/
/*    --proton-tab-block-margin: 4px !important;*/
/*    !* Original: 4px *!*/
/*    --tab-block-margin: 4px !important;*/
/*    !* New version of --proton-tab-block-margin *!*/
/*    --inline-tab-padding: 8px !important;*/
/*    !* Original: 8px *!*/
/*    !* Panel - Like Original *!*/
/*    --arrowpanel-menuitem-padding: 8px !important;*/
/*    !* Original: 8px *!*/
/*}*/


/*======= 标签页最左边空间调整 Tab Bar - Reduce Width, Show more tabs ======================= */
.titlebar-spacer[type="pre-tabs"] {
    width: 20px !important;
    /* Original: 40px */
}

.titlebar-spacer[type="post-tabs"] {
    width: 40px !important;
    /* Original: 40px */
}


/* --固定标签页设置-- */

:root {
    --newtab-button-minus-width-padding: 2px;
    --newtab-button-width-padding: calc(var(--toolbarbutton-inner-padding) - var(--newtab-button-minus-width-padding));
}

#new-tab-button > .toolbarbutton-icon,
#alltabs-button > .toolbarbutton-badge-stack {
    /* Original: calc(2 * var(--toolbarbutton-inner-padding) + 16px) */
    width: calc(2 * var(--newtab-button-width-padding) + 16px) !important;
    /* Original: --toolbarbutton-inner-padding */
    padding-left: var(--newtab-button-width-padding) !important;
    padding-right: var(--newtab-button-width-padding) !important;
}

#tabbrowser-tabs[haspinnedtabs]:not([positionpinnedtabs]) > #tabbrowser-arrowscrollbox > .tabbrowser-tab[first-visible-unpinned-tab] {
    margin-inline-start: 1px !important;
}

:root:not([uidensity=touch]) #tabbrowser-arrowscrollbox {
    --scrollbtn-inner-padding: 1px;
    --scrollbtn-outer-padding: 3px;
}

#scrollbutton-up {
    padding-left: var(--scrollbtn-inner-padding, 4px) !important;
    /* Original: 4px */
    padding-right: var(--scrollbtn-outer-padding, 4px) !important;
}

#scrollbutton-down {
    padding-left: var(--scrollbtn-outer-padding, 4px) !important;
    /* Original: 4px */
    padding-right: var(--scrollbtn-inner-padding, 4px) !important;
}

:root:not([uidensity=touch]) #new-tab-button, #alltabs-button {
    --toolbarbutton-outer-padding: 1px;
    /* Original: 2px*/
}

/* neighbouring tabs should "pinch" together */
.tabbrowser-tab:not([first-visible-tab]) {
    padding-inline: 1px !important;
}

.tabbrowser-tab:is([first-visible-tab]) {
    padding-right: 1px !important;
}


.tabbrowser-tab:not([last-visible-tab]) {
    margin-inline-end: -.5px !important;
}


/*= 标签页设置 Tab Bar - Reduce Height, Show more contents ======================================================== */

/* 参考代码 source form:  https://github.com/black7375/Firefox-UI-Fix*/


/* Toolbar Height */
:root:not([uidensity=touch]) #TabsToolbar {
    --toolbarbutton-inner-padding: 9px;
    /* Original: calc((var(--tab-min-height) - 16px) / 2) = 10px */
}

.toolbar-items, .tabbrowser-tab {
    max-height: 38px;
}

:root[uidensity=compact] .toolbar-items, .tabbrowser-tab {
    max-height: 36px;
}

:root[uidensity=touch] .toolbar-items, .tabbrowser-tab {
    max-height: 45px;
}


/* 标签页滚动按钮设置 Scroll Button - Size Fix*/

:root #tabbrowser-arrowscrollbox {
    --scrollbtn-vertical-padding: 3px;
    --scrollbtn-vertical-border: 2px;
    --scrollbtn-border-radius: 7px;
}

#scrollbutton-up,
#scrollbutton-down {
    /* Original: var(--toolbarbutton-inner-padding) calc(var(--toolbarbutton-inner-padding) - 6px) = 9px */
    /* https://github.com/mozilla/gecko-dev/blob/71b1259afd1cdaf41871ae675c2dadb967ea5b34/browser/themes/shared/toolbarbuttons.inc.css#L142 */
    padding-top: var(--scrollbtn-vertical-padding, var(--toolbarbutton-inner-padding)) !important;
    padding-bottom: var(--scrollbtn-vertical-padding, var(--toolbarbutton-inner-padding)) !important;
    /* Original: 4px */
    border-top-width: var(--scrollbtn-vertical-border, 4px) !important;
    border-bottom-width: var(--scrollbtn-vertical-border, 4px) !important;
    /* Original: calc(var(--tab-border-radius) + 4px) = 8px */
    border-radius: var(--scrollbtn-border-radius, calc(var(--tab-border-radius) + 4px)) !important;
}

:root[tabsintitlebar]:not([uidensity=compact]) #toolbar-menubar[autohide="true"] {
    height: calc(var(--tab-min-height) - var(--tabs-navbar-shadow-size) - 2px);
    /* Compact: 28px, Normal: 33px, Touch: 38px */
}

/* Pinned Tab - Titlechanged Indicator position fix */
:root:not([uidensity=touch]) .tabbrowser-tab:is([image], [pinned]) > .tab-stack > .tab-content[attention]:not([selected="true"]),
:root:not([uidensity=touch]) .tabbrowser-tab > .tab-stack > .tab-content[pinned][titlechanged]:not([selected="true"]) {
    /* Original: center bottom calc(6.5px + var(--tabs-navbar-shadow-size)); */
    background-position-y: bottom calc(4.5px + var(--tabs-navbar-shadow-size)) !important;
}

:root[uidensity=compact] .tabbrowser-tab:is([image], [pinned]) > .tab-stack > .tab-content[attention]:not([selected="true"]),
:root[uidensity=compact] .tabbrowser-tab > .tab-stack > .tab-content[pinned][titlechanged]:not([selected="true"]) {
    /* Original: center bottom calc(6.5px + var(--tabs-navbar-shadow-size)); */
    background-position-y: bottom calc(.5px + var(--tabs-navbar-shadow-size)) !important;
}


/** 去除标签与导航栏之间的空隙 Tab Bar - Connect to window ======================================================== */

.tab-background {
    border-radius: var(--tab-border-radius) var(--tab-border-radius) 0px 0px !important;
    margin-bottom: 0px !important;
}

.tab-content {
    margin-top: var(--tab-block-margin);
}

.tab-stack {
    margin-top: 0px !important;
    margin-bottom: 0px !important;
}

/* Remove line at Toolbar's top */
#tabbrowser-tabs {
    z-index: 1 !important;
}

#tabbrowser-arrowscrollbox[overflowing] .tabbrowser-tab[pinned]:is([visuallyselected], [multiselected]) {
    overflow: hidden;
}


/** 选中标签页与导航栏颜色一致 Selected Tab - Color like toolbar ======================================================== */

:root:not(:-moz-lwtheme) {
    /* Fix for windows's system default theme. Using --toolbar-bgcolor fallback */
    --tab-selected-bgcolor: unset !important; /* Original: rgb(255,255,255); */
}

#tabbrowser-tabs:not([movingtab]) > #tabbrowser-arrowscrollbox > .tabbrowser-tab > .tab-stack > .tab-background[selected="true"]:-moz-lwtheme {
    /* Original: linear-gradient(var(--lwt-selected-tab-background-color, transparent), var(--lwt-selected-tab-background-color, transparent)), linear-gradient(var(--toolbar-bgcolor), var(--toolbar-bgcolor)), var(--lwt-header-image, none)*/
    background-image: linear-gradient(transparent, transparent),
    linear-gradient(var(--toolbar-bgcolor), var(--toolbar-bgcolor)),
    var(--lwt-header-image, none) !important;
}


/* 多个标签时的颜色 Multi Selected Color */
#tabbrowser-tabs > #tabbrowser-arrowscrollbox > .tabbrowser-tab > .tab-stack > .tab-background[multiselected]:not([selected]):-moz-lwtheme {
    background-image: linear-gradient(var(--toolbar-bgcolor, transparent), var(--toolbar-bgcolor, transparent)),
    linear-gradient(var(--toolbar-bgcolor), var(--toolbar-bgcolor)),
    var(--lwt-header-image, none) !important;
}

.tab-background[multiselected="true"]:not([selected="true"]) > .tab-loading-burst:not([bursting]) {
    background: color-mix(in srgb, currentColor 65%, transparent);
    opacity: .3;
}

#TabsToolbar[brighttext] .tab-background[multiselected="true"]:not([selected="true"]) > .tab-loading-burst:not([bursting]) {
    opacity: .15;
}

:root[style*="--lwt-accent-color: rgb(28, 27, 34); --lwt-text-color: rgba(251, 251, 254);"]:root:-moz-lwtheme-brighttext #tabbrowser-tabs:not([movingtab]) > #tabbrowser-arrowscrollbox > .tabbrowser-tab > .tab-stack > .tab-background[multiselected]:not([selected]):-moz-lwtheme {
    background-image: none !important;
    box-shadow: none !important;
}


/* 去除标签页边框 */
.tab-background[multiselected=true] {
    outline: 0px solid color-mix(in srgb, var(--focus-outline-color, currentColor) 0%, transparent) !important;
}


/* 标签页圆角 */
.tab-background {
    border-radius: 5px 5px 0 0 !important;
}

/* 标签页底部圆角 */
:root:not(:-moz-lwtheme) .tab-background::before,
:root:not(:-moz-lwtheme) .tab-background::after {
    content: "" !important;
    display: block !important;
    position: absolute !important;
    width: 8px !important;
    height: 8px !important;
    bottom: 0 !important;
    pointer-events: none !important;
    clip-path: inset(0);
}

:root:not(:-moz-lwtheme) .tab-background::before {
    border-bottom-right-radius: var(--tab-border-radius) !important;
    left: 0 !important;
    transform: translateX(-8px) !important;
    box-shadow: 4px 4px 0 4px var(--uc-tab-corner-bg) !important;
}

:root:not(:-moz-lwtheme) .tab-background::after {
    border-bottom-left-radius: var(--tab-border-radius) !important;
    right: 0 !important;
    transform: translateX(8px) !important;
    box-shadow: -4px 4px 0 4px var(--uc-tab-corner-bg) !important;
}

:root:not(:-moz-lwtheme) .tabbrowser-tab[selected="true"] .tab-background {
    --uc-tab-corner-bg: var(--lwt-selected-tab-background-color, var(--toolbar-bgcolor));
}

:root:not(:-moz-lwtheme) .tab-background:is([selected], [multiselected]) {
    --uc-tab-corner-bg: var(--tab-selected-bgcolor, var(--toolbar-bgcolor));
}


/** Selected Tab - Box Shadow ======================================================== */

#TabsToolbar #tabbrowser-tabs:not([noshadowfortests]) .tabbrowser-tab[visuallyselected="true"]:not(:focus) > .tab-stack > .tab-background:-moz-lwtheme {
    /* Origina: 0 0 1px var(--tab-line-color, rgba(128,128,142,0.9))
       Bright: 0 0 1px var(--tab-line-color, rgba(128,128,142,0.9)), 0 0 4px rgba(128,128,142,0.5) */
    box-shadow: 0 0 0px var(--toolbar-color) !important;
}

#TabsToolbar #tabbrowser-tabs:not([noshadowfortests]) .tabbrowser-tab[multiselected]:not([visuallyselected]) > .tab-stack > .tab-background:-moz-lwtheme {
    box-shadow: 0 0 0px color-mix(in srgb, var(--toolbar-color) 80%, transparent) !important;
}

/* Pinned Tab - tabbrowser-arrowscrollbox overflowing */
#tabbrowser-tabs[positionpinnedtabs] > #tabbrowser-arrowscrollbox > .tabbrowser-tab[pinned] {
    z-index: 0 !important;
}


/** 选中标签页圆角 Selected Tab - Bottom Rounded Corner ======================================================== */

#tabbrowser-tabs {
    --tab-corner-rounding: 4px !important;
    /* 10px looks about like chromium - 17px looks close to Australis tabs */
    --tab-corner-padding: 1px !important;
}

:root[lwtheme="true"] tab[visuallyselected] > stack::before,
:root[lwtheme="true"] tab[visuallyselected] > stack::after {
    /* Box */
    content: "" !important;
    display: block !important;
    position: absolute !important;
    z-index: 1 !important;
    /* Shape */
    width: var(--tab-corner-rounding) !important;
    height: 100% !important;
    /* Color */
    fill: var(--toolbar-bgcolor) !important;
    stroke: var(--tabs-border-color, transparent) !important;
    -moz-context-properties: fill, stroke !important;
    /* Image */
    background-size: var(--tab-corner-rounding);
    background-repeat: no-repeat;
    background-position-y: bottom;
}

:root[lwtheme="true"] tab[visuallyselected] > stack::before {
    left: calc(var(--tab-corner-padding) - var(--tab-corner-rounding)) !important;
    background-image: url(./icons/tab-bottom-corner-left.svg);
}

:root[lwtheme="true"] tab[visuallyselected] > stack::after {
    left: auto;
    right: calc(var(--tab-corner-padding) - var(--tab-corner-rounding));
    background-image: url(./icons/tab-bottom-corner-right.svg);
}


/** 未选中标签页分隔线 Unselected Tab - Divide line ======================================================== */

#tabbrowser-arrowscrollbox {
    position: relative;
}

.tab-content::before {
    left: -1px !important;
}

.tab-content::after {
    right: 0 !important;
}


.tabbrowser-tab:not([visuallyselected]):not(:hover):not([multiselected]) + .tabbrowser-tab:not([visuallyselected]):not(:hover):not([multiselected]) .tab-content::before {
    /* Box Model */
    content: "";
    display: block;
    position: absolute; /* Position */
    top: 50%;
    transform: translateX(-2.5px) translateY(calc(-50% + 1px)); /* Bar shape */
    width: 1.5px;
    height: 20px; /* Bar Color */
    opacity: var(--tab-separator-opacity);
    transition: opacity .2s var(--ease-basic);
    background-color: color-mix(in srgb, currentColor 40%, transparent);
    right: -1px;
}


/* 最后标签页与新标签页距离 Latest Tab & New tab margin ======================================================= */
#tabbrowser-arrowscrollbox:not([overflowing]) .tabbrowser-tab[last-visible-tab] {
    margin-inline-end: 1px !important;
}


/* 新标签页设置 New tab button - Looks like tab */
#tabs-newtab-button {

    /* Original:
        margin: 0 0 var(--tabs-navbar-shadow-size) !important
        => Can't ovrride style. Therefore, we should approach it by bypass.
        */
    --tabs-navbar-shadow-size: -1px; /* Original: 1px */
    --tabs-navbar-original-shadow-size: 1px;

    /* Size */
    -moz-box-align: stretch !important;
    padding-top: var(--tab-block-margin) !important;
}

#tabs-newtab-button > .toolbarbutton-icon {
    border-radius: var(--tab-border-radius) var(--tab-border-radius) 0 0 !important; /* Original: var(--tab-border-radius) */
}

/* Coner Rounding */
#tabs-newtab-button:hover {
    /* Color */
    fill: color-mix(in srgb, currentColor 17%, transparent) !important; /* Replace var(--toolbarbutton-hover-background) - Hard coded for compatibility */
    -moz-context-properties: fill !important;

    /* Corner Image */
    --newtab-position: calc((var(--tab-corner-rounding) / 2) * -1);
    background-image: url("./icons/tab-bottom-corner-left.svg"), url("./icons/tab-bottom-corner-right.svg");
    background-repeat: no-repeat;
    background-position: left var(--newtab-position) bottom var(--tabs-navbar-original-shadow-size), right var(--newtab-position) bottom var(--tabs-navbar-original-shadow-size);
    background-size: var(--tab-corner-rounding);
}

#tabs-newtab-button .toolbarbutton-icon {
    padding: calc(var(--toolbarbutton-inner-padding) - (var(--tab-block-margin) / 4)) var(--toolbarbutton-inner-padding) calc(var(--toolbarbutton-inner-padding) + (var(--tab-block-margin) / 4) + var(--tabs-navbar-original-shadow-size)) !important;
    -moz-context-properties: fill, fill-opacity;
    fill: var(--toolbarbutton-icon-fill);
    fill-opacity: var(--toolbarbutton-icon-fill-opacity);
}

:-moz-lwtheme-brighttext#tabs-newtab-button:hover .toolbarbutton-icon {
    background-color: #475465 !important;
}


/** Clipped tabs - Letters cleary ****************************************** */

#tabbrowser-tabs[closebuttons=activetab] .tab-content:not([pinned]) {
    padding-inline-start: 8px !important;
}

#tabbrowser-tabs[closebuttons=activetab] .tab-label-container[textoverflow][labeldirection="ltr"]:not([pinned]),
#tabbrowser-tabs[closebuttons=activetab] .tab-label-container[textoverflow]:not([labeldirection]):-moz-locale-dir(ltr):not([pinned]) {
    mask-image: linear-gradient(to right, black 70%, transparent) !important;
}

#tabbrowser-tabs[closebuttons=activetab] .tab-label-container[textoverflow][labeldirection="rtl"]:not([pinned]),
#tabbrowser-tabs[closebuttons=activetab] .tab-label-container[textoverflow]:not([labeldirection]):-moz-locale-dir(rtl):not([pinned]) {
    mask-image: linear-gradient(to left, black 70%, transparent) !important;
}

/** 鼠标放上去才显示关闭按钮 Clipped tabs - Show close button at hover *******************************/
#tabbrowser-tabs[closebuttons="activetab"] > #tabbrowser-arrowscrollbox > .tabbrowser-tab:not([pinned]) > .tab-stack > .tab-content > .tab-close-button:not([selected="true"]) {
    display: inline !important;
}

#tabbrowser-tabs[closebuttons=activetab] .tabbrowser-tab:not([visuallyselected], :hover) .tab-close-button {
    visibility: collapse !important;
}


/** 声音播放中的标签页 Sound Tab - Hide Label *======================================================== */

.tab-secondary-label:is([soundplaying], [muted], [activemedia-blocked], [pictureinpicture]) {
    display: none !important;
}

/** Sound Tab - Show with Favicons **/
/* Makes the favicons always visible (also on hover) */
.tab-icon-image:not([pinned]) {
    opacity: 1 !important
}

/* Makes the speaker icon to always appear if the tab is playing (not only on hover) */
.tab-icon-overlay:not([crashed]),
.tab-icon-overlay[pinned][crashed][selected] {
    /* Position */
    top: -3.5px !important;
    inset-inline-end: -9px !important;
    z-index: 1 !important;

    /* Shape */
    padding: 1.5px !important;
    border-radius: 10px !important;
    width: 17px !important;
    height: 17px !important;
}

.tab-icon-overlay:not([sharing], [crashed]):is([soundplaying], [muted], [activemedia-blocked]) {
    /* Color */
    color: currentColor !important;
    stroke: transparent !important;
    background: transparent !important;
    fill-opacity: 0.8 !important;
    opacity: 1 !important;
}

.tab-icon-overlay:not([pinned], [sharing], [crashed]):is([soundplaying], [muted], [activemedia-blocked]) {
    margin-inline-end: 9.5px !important;
}

/* None exist favicon */
.tabbrowser-tab:not([image]) .tab-icon-overlay:not([pinned], [sharing],[crashed]) {
    top: 0 !important;
    inset-inline-end: 0 !important;
    margin-inline-end: 5.5px !important;
    padding: 2px 0 !important;
}

/* Busy - Show */
.tab-throbber[busy], .tab-icon-pending[busy] {
    opacity: 1 !important;
}

/* Busy - Overlay Position */
.tabbrowser-tab:not([pinned])[busy] .tab-icon-overlay:is([soundplaying], [muted], [activemedia-blocked]) {
    transform: translateX(-.5px) translateY(-2.5px);
}

.tabbrowser-tab:not([image]) .tab-icon-overlay:not([pinned], [sharing],[crashed])[busy] {
    top: -3.5px !important;
    inset-inline-end: -9px !important;
    margin-inline-end: 9.5px !important;
    padding: 1.5px !important;
}

/* Hover */
.tab-icon-overlay:not([crashed])[soundplaying]:hover,
.tab-icon-overlay:not([crashed])[muted]:hover,
.tab-icon-overlay:not([crashed])[activemedia-blocked]:hover {
    color: var(--toolbar-bgcolor, white) !important;
    stroke: var(--lwt-tab-text, var(--toolbar-color)) !important;
    background-color: var(--lwt-tab-text, var(--toolbar-color)) !important;
    fill-opacity: 0.95 !important;
}

#TabsToolbar[brighttext] .tab-icon-overlay:not([crashed])[soundplaying]:hover,
#TabsToolbar[brighttext] .tab-icon-overlay:not([crashed])[muted]:hover,
#TabsToolbar[brighttext] .tab-icon-overlay:not([crashed])[activemedia-blocked]:hover {
    color: var(--toolbar-bgcolor, black) !important;
}

.tabbrowser-tab:not([image]) .tab-icon-overlay:not([pinned], [sharing],[crashed]):hover {
    padding: 0 !important;
}


/** 视频画中画标签页 PictureInPicture Tab - Show PIP Icon ======================================================== */
.tab-icon-sound[pictureinpicture]:not([pinned]) {
    /* Shape */
    display: -moz-inline-box !important;
    width: 14px;
    height: 14px;
    -moz-box-ordinal-group: 2 !important;

    /* Color */
    fill: currentColor;
    opacity: 0.8;
    -moz-context-properties: fill;

    /* Icon */
    list-style-image: url(chrome://global/skin/media/picture-in-picture-open.svg);
}

.tab-icon-sound[pictureinpicture]:not([pinned])[selected] {
    opacity: 0.95;
}

/* Close Button's position */
.tabbrowser-tab[pictureinpicture]:not([pinned]) .tab-close-button {
    margin-left: 7px !important;
    -moz-box-ordinal-group: 2 !important;
}

.tabbrowser-tab[pictureinpicture]:not([pinned]):hover .tab-close-button {
    margin-left: 0px !important;
}


/** 身份标签页 Container Tab - Color line at icon's bottom ======================================================== */
.tab-context-line {
    display: none;
}

.tab-icon-image {
    box-sizing: content-box;
    padding: 3px 0;

    border-bottom: 2px solid var(--identity-icon-color);
}

/* None exist favicon - With Sound */
.tabbrowser-tab:not([image]) .tab-icon-overlay:not([pinned], [sharing], [crashed]):is([soundplaying], [muted], [activemedia-blocked]) {
    box-sizing: content-box;
    padding: 3px 0;

    border-radius: 0 !important;
    border-bottom: 2px solid var(--identity-icon-color);
}

.tabbrowser-tab:not([image]) .tab-icon-overlay:not([pinned], [sharing], [crashed]):is([soundplaying], [muted], [activemedia-blocked]):hover {
    padding: 0;

    border-radius: 10px !important;
    border-bottom: none;
}

/* Pinned Tab - Titlechanged Indicator override */
.tabbrowser-tab:is([image], [pinned]) > .tab-stack > .tab-content[attention]:not([selected="true"]) .tab-icon-image,
.tabbrowser-tab > .tab-stack > .tab-content[pinned][titlechanged]:not([selected="true"]) .tab-icon-image {
    border-bottom: 2px solid transparent !important;
}

.tabbrowser-tab:is([image], [pinned])[usercontextid] > .tab-stack > .tab-content[attention]:not([selected="true"]),
.tabbrowser-tab[usercontextid] > .tab-stack > .tab-content[pinned][titlechanged]:not([selected="true"]) {
    /* Original: radial-gradient(circle, var(--attention-icon-color), var(--attention-icon-color) 2px, transparent 2px); */
    --dotted-identity-image: radial-gradient(circle, var(--identity-icon-color), var(--identity-icon-color) 2px, transparent 2px);
    background-image: var(--dotted-identity-image), var(--dotted-identity-image), var(--dotted-identity-image) !important;
    background-position-x: 32%, 50%, 70% !important;
}

:root[uidensity=compact] .tabbrowser-tab:is([image], [pinned])[usercontextid] > .tab-stack > .tab-content[attention]:not([selected="true"]),
:root[uidensity=compact] .tabbrowser-tab[usercontextid] > .tab-stack > .tab-content[pinned][titlechanged]:not([selected="true"]) {
    /* Original: radial-gradient(circle, var(--attention-icon-color), var(--attention-icon-color) 2px, transparent 2px); */
var(--dotted-identity-image) !important;
    background-position-x: 30%, 50%, 70% !important;
}

/* Pinned Tab - Titlechanged & soundplaying */
.tabbrowser-tab:is([image], [pinned])[usercontextid]:is([soundplaying], [muted], [activemedia-blocked]) > .tab-stack > .tab-content[attention]:not([selected="true"]),
.tabbrowser-tab[usercontextid]:is([soundplaying], [muted], [activemedia-blocked]) > .tab-stack > .tab-content[pinned][titlechanged]:not([selected="true"]) {
    background-position-x: calc(32% - 1px), calc(50% - 1px), calc(70% - 1px) !important;
}

:root[uidensity=compact] .tabbrowser-tab:is([image], [pinned])[usercontextid]:is([soundplaying], [muted], [activemedia-blocked]) > .tab-stack > .tab-content[attention]:not([selected="true"]),
:root[uidensity=compact] .tabbrowser-tab[usercontextid]:is([soundplaying], [muted], [activemedia-blocked]) > .tab-stack > .tab-content[pinned][titlechanged]:not([selected="true"]) {
var(--dotted-identity-image) !important;
    background-position-x: calc(30% - 1px), calc(50% - 1px), calc(70% - 1px) !important;
}

/** Crashed Tab - Don't show Favicons **/
.tab-icon-image[crashed] {
    display: none !important;
}



